<%- include('../components/header', {title: `${course.title} | TechCourses Market`}) %>

<!-- Custom CSS -->
    <style>
        .sidebar {
            height: calc(100vh - 56px);
            overflow-y: auto;
            position: sticky;
            top: 56px;
            scroll-margin-right: 10px;
        }
        .list-group-item.active {
            color: #000;
            background-color: #f8f9fa;
            border-left: 3px solid #0d6efd;
        }
        .progress-thumbnail {
            width: 80px;
            height: 45px;
            object-fit: cover;
        }
        .completed {
            color: #198754;
        }

        /* video player */
        .control-btn{
            background: none;
            border: none;
            color: white;
        }
        .video-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }
        .video-controls{
            cursor: pointer;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
            padding: 20px 15px 15px;
        }
        .video-player-container:hover .video-controls{
            transform: translateY(0);
        }
        .video-player-container:hover #customVideo{
            opacity: 0.8;
        }
        .volume-slider{
            background: rgba(255,255,255,0.3);
            transform-origin: left;
            transform: scaleX(0);
            transition: transform .3s ease-in-out;
        }
        .volume-container:hover .volume-slider{
            cursor: pointer;
            transform-origin: left;
            transform: scaleX(1);
        }
    </style>

    <!-- Main Content -->
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar - Course Content -->
            <div class="col-lg-3 col-md-4 p-0 bg-light sidebar d-none d-md-block">
                <div class="p-3">
                    <h5 class="mb-3"><%= course.title %></h5>
                    <div class="progress mb-3">
                        <div class="progress-bar" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
                    </div>
                    <div class="d-flex justify-content-between mb-3">
                        <small>8 of 32 lectures completed</small>
                        <button class="btn btn-sm btn-outline-secondary">Mark as Completed</button>
                    </div>
                </div>

                <div class="list-group list-group-flush rounded-0">
                    <% course.sections.forEach(function(section){ %>
                        <button 
                            class="list-group-item bg-light fw-bold" 
                            type="button" 
                            data-bs-toggle="collapse" 
                            data-bs-target="#section<%= section.id %>" 
                            aria-expanded="false" 
                            aria-controls="section<%= section.id %>">
                            Section <%= section.id %>: <%= section.title %>
                            <i class="fas fa-chevron-down float-end"></i>
                        </button>
                        <div class="collapse" id="section<%= section.id %>">
                            <% section.lectures.forEach(function(lecture){ %>
                                <a href="#" class="list-group-item list-group-item-action ps-4">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span><i class="bi bi-play-circle-fill me-2"></i><%= lecture.title %></span>
                                        <span class="badge bg-secondary"><%= lecture.duration %></span>
                                    </div>
                                </a>
                            <% }); %>
                        </div>
                    <% }); %>
                </div>
            </div>

            <!-- Main Content Area -->
            <div class="col-lg-9 col-md-8 col-12">
                <div class="p-3 border-bottom d-flex justify-content-between align-items-center">
                    <h1 class="h4 mb-0">Introduction to HTML</h1>
                    <div class="dropdown">
                        <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="resourcesDropdown" data-bs-toggle="dropdown">
                            <i class="bi bi-download"></i> Resources
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#"><i class="bi bi-file-earmark-pdf"></i> Lecture Slides</a></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-file-earmark-code"></i> Example Code</a></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-file-earmark-text"></i> Cheat Sheet</a></li>
                        </ul>
                    </div>
                </div>

                <!-- Video Player -->
                <div class="video-player-container position-relative overflow-hidden ratio-16x9 bg-black rounded-3" style="box-shadow: 0 8px 32px rgba(0,0,0,0.5); margin-bottom: 2rem;">
                    <div class="video-wrapper position-relative w-100">
                        <video class="w-100 h-100 object-fit-cover" id="customVideo" preload="metadata">
                            <source src="#" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                        <div class="video-overlay position-absolute w-100 h-100 top-0 start-0 d-flex justify-content-center align-items-center" id="videoOverlay">
                            <div class="play-button">
                                <i class="fas fa-play text-white fa-2x"></i>
                            </div>
                        </div>
                        <div class="video-controls w-100 position-absolute bottom-0 start-0" id="videoControls">
                            <div class="progress-container" style="margin-bottom: 15px;">
                                <div class="video-progress w-100 position-relative rounded-3" style="height: 6px; background-color: white;" id="videoProgress">
                                    <div class="video-progress-buffer position-absolute top-0 start-0 h-100 bg-secondary" style="width: 0;" id="progressBuffer"></div>
                                    <div class="video-progress-bar h-100 bg-info rounded-3" style="width: 0;" id="progressBar"></div>
                                </div>
                            </div>
                            <div class="controls-row px-3 d-flex justify-content-around align-items-center">
                                <div class="d-flex align-items-center" style="gap: 15px;">
                                    <button class="control-btn" id="playPauseBtn">
                                        <i class="fas fa-play"></i>
                                    </button>
                                    <button class="control-btn" id="rewindBtn">
                                        <i class="fas fa-backward"></i>
                                    </button>
                                    <button class="control-btn" id="forwardBtn">
                                        <i class="fas fa-forward"></i>
                                    </button>
                                    <div class="time-display text-white">
                                        <span id="currentTime">0:00</span> / <span id="duration">0:00</span>
                                    </div>
                                    <div class="volume-container">
                                        <button class="control-btn" id="muteBtn">
                                            <i class="fas fa-volume-up"></i>
                                        </button>
                                        <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="25">
                                    </div>
                                </div>
                                <div class="d-flex align-items-center" style="gap: 15px;">
                                    <select class="speed-selector" id="speedSelector">
                                        <option value="0.5">0.5x</option>
                                        <option value="0.75">0.75x</option>
                                        <option value="1" selected>1x</option>
                                        <option value="1.25">1.25x</option>
                                        <option value="1.5">1.5x</option>
                                        <option value="2">2x</option>
                                    </select>
                                    <button class="control-btn" id="fullscreenBtn">
                                        <i class="fas fa-expand"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Lecture Description -->
                <div class="p-4">
                    <h3 class="h5">About this lecture</h3>
                    <p>In this lecture, you'll learn the fundamentals of HTML, the standard markup language for creating web pages. We'll cover the basic structure of an HTML document, common tags, and how to create your first web page.</p>
                    
                    <div class="alert alert-info mt-4">
                        <i class="bi bi-lightbulb"></i> <strong>Pro Tip:</strong> Practice along with the video by creating your own HTML file and experimenting with the tags we discuss.
                    </div>
                </div>

                <!-- Discussion & Notes Section -->
                <div class="p-4 border-top">
                    <ul class="nav nav-tabs" id="lectureTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="notes-tab" data-bs-toggle="tab" data-bs-target="#notes" type="button">Notes</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="discussion-tab" data-bs-toggle="tab" data-bs-target="#discussion" type="button">Discussion</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="resources-tab" data-bs-toggle="tab" data-bs-target="#resources" type="button">Resources</button>
                        </li>
                    </ul>
                    <div class="tab-content p-3 border-start border-end border-bottom" id="lectureTabsContent">
                        <div class="tab-pane fade show active" id="notes" role="tabpanel">
                            <div class="mb-3">
                                <textarea class="form-control" rows="5" placeholder="Add your personal notes here..."></textarea>
                                <div class="d-flex justify-content-end mt-2">
                                    <button class="btn btn-primary btn-sm">Save Notes</button>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-header">
                                    Saved Notes
                                </div>
                                <div class="card-body">
                                    <p class="card-text">HTML stands for HyperText Markup Language. The basic structure includes &lt;html&gt;, &lt;head&gt;, and &lt;body&gt; tags.</p>
                                    <small class="text-muted">Last updated 2 days ago</small>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="discussion" role="tabpanel">
                            <div class="mb-3">
                                <textarea class="form-control" rows="3" placeholder="Ask a question or contribute to the discussion..."></textarea>
                                <div class="d-flex justify-content-end mt-2">
                                    <button class="btn btn-primary btn-sm">Post Comment</button>
                                </div>
                            </div>
                            <div class="list-group">
                                <div class="list-group-item">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h6 class="mb-1">Sarah Johnson</h6>
                                        <small>3 days ago</small>
                                    </div>
                                    <p class="mb-1">What's the difference between HTML5 and previous versions?</p>
                                    <small><a href="#" class="text-decoration-none">Reply</a></small>
                                </div>
                                <div class="list-group-item">
                                    <div class="d-flex w-100 justify-content-between">
                                        <h6 class="mb-1">Instructor</h6>
                                        <small>2 days ago</small>
                                    </div>
                                    <p class="mb-1">HTML5 introduced new semantic elements like &lt;header&gt;, &lt;footer&gt;, and &lt;article&gt;, as well as native support for audio and video elements.</p>
                                    <small><a href="#" class="text-decoration-none">Reply</a></small>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="resources" role="tabpanel">
                            <div class="list-group">
                                <a href="#" class="list-group-item list-group-item-action">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <i class="bi bi-file-earmark-pdf text-danger"></i> HTML5 Cheat Sheet.pdf
                                        </div>
                                        <small class="text-muted">2.4 MB</small>
                                    </div>
                                </a>
                                <a href="#" class="list-group-item list-group-item-action">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <i class="bi bi-file-earmark-code text-primary"></i> Lecture Examples.zip
                                        </div>
                                        <small class="text-muted">1.1 MB</small>
                                    </div>
                                </a>
                                <a href="#" class="list-group-item list-group-item-action">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <i class="bi bi-link-45deg"></i> W3Schools HTML Reference
                                        </div>
                                        <small class="text-muted">External Link</small>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Bottom Navigation (for smaller screens) -->
    <div class="d-block d-md-none fixed-bottom bg-white border-top">
        <div class="container">
            <div class="row py-2">
                <div class="col-4 text-center">
                    <button class="btn btn-link" data-bs-toggle="offcanvas" data-bs-target="#mobileSidebar">
                        <i class="bi bi-list-ul"></i><br>
                        <small>Content</small>
                    </button>
                </div>
                <div class="col-4 text-center">
                    <a href="#" class="btn btn-link">
                        <i class="bi bi-journal-text"></i><br>
                        <small>Notes</small>
                    </a>
                </div>
                <div class="col-4 text-center">
                    <a href="#" class="btn btn-link">
                        <i class="bi bi-download"></i><br>
                        <small>Resources</small>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Sidebar Offcanvas -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="mobileSidebar">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title">Course Content</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body">
            <div class="progress mb-3">
                <div class="progress-bar" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
            </div>
            <div class="list-group list-group-flush">
                <div class="list-group-item bg-light fw-bold">Section 1: HTML Fundamentals</div>
                <a href="#" class="list-group-item list-group-item-action active">
                    <div class="d-flex justify-content-between align-items-center">
                        <span><i class="bi bi-play-circle-fill me-2"></i> Introduction to HTML</span>
                        <span class="badge bg-secondary">12:45</span>
                    </div>
                </a>
                <!-- More mobile sidebar items... -->
            </div>
        </div>
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="/js/learning.js"></script>
</body>
</html>